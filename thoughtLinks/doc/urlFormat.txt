--Linking--

http://<ADDRESS>/request?from_proxy=<ADDRESS>&link_from_page_title=<NAME>&link_from_page_url=<URL>&link_to_page_url=<URL>

<ADDRESS>
a valid internet address, either a resolvable DNS name or an IPv4/6 numerical
address in XXX.XXX.XXX.XXX ascii format.

<URL>
a valid URL, encoded using standard escaped character representation
for URLs

from_proxy
the address of the proxy that generated this link wrapper.

link_from_page_title
the title of the page containing the link that was clicked.

link_from_page_url
the URL of the page containing the link that was clicked.

link_to_page_url
the URL of the unwrapped link target.


For example, suppose we have two proxies, A and B, at "proxya.com" and 
"proxyb.com", respectively.  Suppose that proxy A is processing the page 
designated by the URL "http://servera.com/testA.html", and the page HTML 
content looks like:

<HTML>
<HEAD>
<TITLE>Test Page</TITLE>
</HEAD>
<BODY>
<A HREF="http://serverb.com/testB.html">a link</A>
</BODY>
</HTML>


Suppose that proxy A's hash function indicates that proxy B is the best
proxy to wrap the contents of the page at http://serverb.com/testB.html.
The body of the wrapped page served by proxy A to the client will look like:

<HTML>
<HEAD>
<TITLE>Test Page</TITLE>
</HEAD>
<BODY>
<A HREF="http://proxyb.com/request?from_proxy=proxya.com&link_from_page_title=Test+Page&link_from_page_url=http%3A%2F%2Fservera.com%2Ftesta.html&link_to_page_url=http%3A%2F%2Fserverb.com%2Ftestb.html">a link</A>
</BODY>
</HTML>


Note that this page does not show the header block that proxy A will insert
at the top of the page (which would contain backwards links and exit links).

For clarity, an un-encoded version of the HREF above would be:

http://proxyb.com/request?from_proxy=proxya.com&link_from_page_title=Test Page&link_from_page_url=http://servera.com/testa.html&link_to_page_url=http://serverb.com/testb.html




--Exit linking--

http://<ADDRESS>/exit?link_from_page_title=<NAME>&link_from_page_url=<URL>&link_to_page_url=<URL>


This URL format causes the serving proxy to obtain (using the Linking
URL described above) a wrapped page from its best-match next proxy and 
pass the page unmodified to the client.

This mechanism allows the proxy to track the links used to exit one of the
pages that it manages.


If, in the above example, proxy A wanted to track the exit links for
http://servera.com/testA.html, it would generate a wrapped page that
has a body like:

<HTML>
<HEAD>
<TITLE>Test Page</TITLE>
</HEAD>
<BODY>
<A HREF="http://proxya.com/exit?from_proxy=proxya.com&link_from_page_title=Test+Page&link_from_page_url=http%3A%2F%2Fservera.com%2Ftesta.html&link_to_page_url=http%3A%2F%2Fserverb.com%2Ftestb.html">a link</A>
</BODY>
</HTML>

Whenever it received the above exit request, it would fetch the following
URL from proxy B:

http://proxyb.com/request?link_from_page_title=Test+Page&link_from_page_url=http%3A%2F%2Fservera.com%2Ftesta.html&link_to_page_url=http%3A%2F%2Fserverb.com%2Ftestb.html

It would forward the content served by B directly to the client.  Note that
proxy B will control the wrapping of all links in testb.html, so 
semantically, we are exiting proxy A, even though A is serving the target
page of the exit.




--Searching--

http://<ADDRESS>/search?from_page_title=<NAME>&from_page_url=<URL>&query=<STRING>


<STRING>
An escaped-character-encoded stirng.


from_page_title
the title of the page from which the search was invoked.


from_page_url
the page from which the search was invoked.


query
the search query string.



The result page, generated by a publicly accessible search engine, will
be processed and wrapped by the current proxy.  The proxy will insert
exit-link wrappers (or simply request wrappers, if it does not track
exit links) for each result link in the search engine's result page.  

No header of special links should be attached to a search results page,
though some header indicating that the page is wrapped is recommended.



