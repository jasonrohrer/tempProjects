#!/bin/bash

#
# Modification History
#
# 2004-November-13   Jason Rohrer
# Created.  Modified from Monolith source.
#
# 2005-January-10   Jason Rohrer
# Commented out wxWindows stuff.
#


while [ -z "$platformSelection" ]
do
    echo "select platform:"

    echo "  1 --  GNU/Linux X86"
    echo "  2 --  GNU/Linux PPC"
    echo "  3 --  FreeBSD X86"
    echo "  4 --  MacOSX"
    echo "  5 --  Solaris"
    echo "  6 --  Win32 using MinGW"
    echo "  q --  quit"

    echo ""
    echo -n "> "

    read platformSelection

	
	if [ "$platformSelection" = "q" ]
    then
        exit
    fi


    # use ASCII comparison.

	if [[ "$platformSelection" > "6" ]]
    then
        platformSelection=""
    fi

    if [[ "$platformSelection" < "1" ]]
    then
        platformSelection=""
    fi

done


# only needed for win32 at the moment (-lwsock32)
extraWxLibs=""


#  echo ""
#  echo ""
#  echo "Enter full path to wxWindows wx-config script."
#  echo "   Example:   /usr/bin/wx-config"
#  echo "To us the default setting, or if you do not plan to build the"
#  echo "wxWindows-based GUI, leave this blank."

#  echo ""
#  echo -n "> "

#  read wxConfigPath


#  if [ "$wxConfigPath" = "" ]
#  then
#      wxConfigPath="/usr/bin/wx-config"
#  fi



platformName="Generic"
platformMakefile="generic"



case "$platformSelection" in


    "1" )
        platformName="GNU/Linux X86"
        platformMakefile="Makefile.GnuLinuxX86"
    ;;


    "2" )
        platformName="GNU/Linux PPC"
        platformMakefile="Makefile.GnuLinuxPPC"
    ;;


    "3" )
        platformName="FreeBSD X86"
        platformMakefile="Makefile.FreeBSDX86"
    ;;


    "4" )
        platformName="MacOSX"
        platformMakefile="Makefile.MacOSX"
    ;;


    "5" )
        platformName="Solaris"
        platformMakefile="Makefile.Solaris"
    ;;


    "6" )
        platformName="Win32 MinGW"
        platformMakefile="Makefile.MinGW"
    ;;


esac


minorGemsMakefile="../minorGems/build/Makefile.minorGems"
minorGemsMakefile_targets="../minorGems/build/Makefile.minorGems_targets"

rm -f Makefile.temp
echo "# Auto-generated by Primrose/configure for the $platformName platform.  Do not edit manually." > Makefile.temp

rm -f crypto/Makefile
cat Makefile.temp $platformMakefile Makefile.common $minorGemsMakefile crypto/Makefile.all $minorGemsMakefile_targets > crypto/Makefile

rm -f api/Makefile
cat Makefile.temp $platformMakefile Makefile.common $minorGemsMakefile api/Makefile.all $minorGemsMakefile_targets > api/Makefile

rm -f userInterface/text/Makefile
cat Makefile.temp $platformMakefile Makefile.common $minorGemsMakefile userInterface/text/Makefile.all $minorGemsMakefile_targets > userInterface/text/Makefile

rm -f util/Makefile
cat Makefile.temp $platformMakefile Makefile.common $minorGemsMakefile util/Makefile.all $minorGemsMakefile_targets > util/Makefile

rm Makefile.temp
		
#  echo -e \
#   "# Auto-generated by Primrose/configure for the $platformName platform." \
#   "\n# Do not edit manually.\n" \
#   "\nWX_CONFIG_LOCATION = $wxConfigPath" \
#   "\nEXTRA_WX_LIBS = $extraWxLibs\n" > Makefile.temp

#  rm -f userInterface/wxWindows/Makefile
#  cat Makefile.temp $platformMakefile Makefile.common $minorGemsMakefile userInterface/wxWindows/Makefile.all $minorGemsMakefile_targets > userInterface/wxWindows/Makefile

#  rm Makefile.temp






exit
